{% extends "base.html" %}

{% block title %}{{ client.nom }} - Détail client{% endblock %}

{% block content %}
<!-- Fil d'Ariane -->
{% include 'dashboard/components/breadcrumb.html' with items=breadcrumb_items %}

<!-- Header client (statique) -->
{% include 'dashboard/detail/header.html' %}

<!-- Navigation des tabs (HTMX + Alpine.js) -->
<div class="card bg-base-100 shadow-sm">
    <div class="card-body p-0">
        <!-- Tabs navigation RESPONSIVE avec Alpine.js -->
        <div x-data="{ activeTab: '{{ current_tab }}' }"
             role="tablist"
             class="tabs tabs-boxed lg:tabs-lifted tabs-sm lg:tabs-lg overflow-x-auto">

            <button role="tab"
                    @click="activeTab = 'info'"
                    :class="{ 'tab-active': activeTab === 'info' }"
                    class="tab"
                    hx-get="{% url 'dashboard:detail' client.id %}?tab=info"
                    hx-target="#tabContent"
                    hx-push-url="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 lg:mr-2" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span class="hidden lg:inline">Informations</span>
                <span class="lg:hidden">Info</span>
            </button>

            <button role="tab"
                    @click="activeTab = 'projets'"
                    :class="{ 'tab-active': activeTab === 'projets' }"
                    class="tab"
                    hx-get="{% url 'dashboard:detail' client.id %}?tab=projets"
                    hx-target="#tabContent"
                    hx-push-url="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 lg:mr-2" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span class="hidden lg:inline">Projets</span>
                <span class="lg:hidden">Projets</span>
            </button>

            <button role="tab"
                    @click="activeTab = 'stats'"
                    :class="{ 'tab-active': activeTab === 'stats' }"
                    class="tab"
                    hx-get="{% url 'dashboard:detail' client.id %}?tab=stats"
                    hx-target="#tabContent"
                    hx-push-url="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 lg:mr-2" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                <span class="hidden lg:inline">Statistiques</span>
                <span class="lg:hidden">Stats</span>
            </button>

            <button role="tab"
                    @click="activeTab = 'timeline'"
                    :class="{ 'tab-active': activeTab === 'timeline' }"
                    class="tab"
                    hx-get="{% url 'dashboard:detail' client.id %}?tab=timeline"
                    hx-target="#tabContent"
                    hx-push-url="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 lg:mr-2" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span class="hidden lg:inline">Activité</span>
                <span class="lg:hidden">Act.</span>
            </button>
        </div>

        <!-- Contenu dynamique des tabs -->
        <div id="tabContent"
             class="p-4 lg:p-6">
            <!-- Premier chargement: onglet info par défaut -->
            {% include 'dashboard/detail/tab_info.html' %}
        </div>
    </div>
</div>
{% endblock %}